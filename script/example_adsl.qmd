---
title: "Example ADSL Data Derivation"
format: gfm
---

# Update YAML Spec 

```{python}
import sys
sys.path.insert(0, 'src')

from adam_yaml import AdamSpec
```

```{python}
# create spec with schema validation
adsl_spec1 = AdamSpec("../spec/adsl_study1.yaml", schema_path="../spec/schema.yaml")
adsl_spec2 = AdamSpec("../spec/adsl_study2.yaml", schema_path="../spec/schema.yaml")

# store the combined YAML file
adsl_spec1.save("../spec/adsl_study_combined1.yaml")
adsl_spec2.save("../spec/adsl_study_combined2.yaml")
```

# Derive ADSL Data 

```{python}
import polars as pl 
```

```{python}
pl.Config.set_tbl_cols(-1)  # Show all columns
pl.Config.set_tbl_rows(20)  # Show up to 20 rows
pl.Config.set_fmt_str_lengths(100)  # Show longer strings
```

## Load SDTM datasets
```{python}
ig = pl.read_csv("../ADaMIG/ADaMIG_v1.3.csv")
dm = pl.read_parquet("../data/sdtm/dm.parquet")
sv = pl.read_parquet("../data/sdtm/dm.parquet")
vs = pl.read_parquet("../data/sdtm/vs.parquet")
```
