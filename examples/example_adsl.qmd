---
title: "Example ADSL Data Derivation"
format: gfm
---

# YAML Spec Preparation

```{python}
from adamyaml import AdamSpec
```

```{python}
import polars as pl 

pl.Config.set_tbl_cols(-1)  # Show all columns
pl.Config.set_tbl_rows(20)  # Show up to 20 rows
pl.Config.set_fmt_str_lengths(100)  # Show longer strings
```

```{python}
# create spec with schema validation
adsl_spec1 = AdamSpec("../spec/adsl_study1.yaml")
adsl_spec1.save("../spec/adsl_study_combined1.yaml")

adsl_spec2 = AdamSpec("../spec/adsl_study2.yaml")
adsl_spec2.save("../spec/adsl_study_combined2.yaml")
```

```{python}
pl.DataFrame(adsl_spec1.get_data_dependency())
```

# Derive ADSL Data 

```{python}
from adamyaml.adam_derivation.engine import AdamDerivation
```

```{python}
adsl_derivation = AdamDerivation("../spec/adsl_study1.yaml")
```

## Load SDTM datasets
```{python}
ig = pl.read_csv("../ADaMIG/ADaMIG_v1.3.csv")
dm = pl.read_parquet("../data/sdtm/dm.parquet")
sv = pl.read_parquet("../data/sdtm/dm.parquet")
vs = pl.read_parquet("../data/sdtm/vs.parquet")
```

